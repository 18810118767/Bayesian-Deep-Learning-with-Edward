<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Edward – Classes of Inference</title>
  <!-- Mobile Specific Metas -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- FONT -->
  <link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700" rel="stylesheet">

  <!-- CSS -->
  <link rel="stylesheet" href="/css/normalize.css">
  <link rel="stylesheet" href="/css/skeleton.css">
  <!-- Dynamically resize logo for mobile -->
  <style type="text/css">
  .logo-width {
    width: 100%;
    box-sizing: border-box;
    margin-bottom: 15%;
  }
  /* Roughly the point when website is single column */
  @media (max-width: 850px) {
    .logo-width {
      width: 50%;
      box-sizing: border-box;
      margin-bottom: 5%;
    }
  }
  </style>

  <!-- KaTeX -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/contrib/auto-render.min.js"></script>

  <!-- highlight.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/highlight.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/github.min.css">

  <!-- Favicon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/icons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/icons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/icons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/icons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/icons/manifest.json">
  <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#5bbad5">
  <link rel="shortcut icon" href="/icons/favicon.ico">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/icons/mstile-144x144.png">
  <meta name="msapplication-config" content="/icons/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div class="container">
  <div class="row" style="margin-top: 5%">
    <div class="three columns">
    <h1><a href="/">Edward</a></h1>
    <a href="/">
    <center>
      <img src="/images/edward.png" class="logo-width" alt="Edward" />
    </center>
    </a>
    <a class="button u-full-width" href="/">Home</a>
    <a class="button u-full-width" href="/getting-started">Getting Started</a>
    <a class="button u-full-width" href="/tutorials/">Tutorials</a>
    <a class="button u-full-width" href="/api/">API</a>
    <a class="button u-full-width" href="#">Advanced</a>
    <a class="button2 u-full-width" href="/design-philosophy">Design Philosophy</a>
    <a class="button2 u-full-width" href="/contributing">Contributing</a>
    <a class="button2 u-full-width" href="/troubleshooting">Troubleshooting</a>
    <a class="button2 u-full-width" href="/license">License</a>
    <div class="row" style="padding-bottom: 5%"> </div>
    <a href="https://github.com/blei-lab/edward">
    <!-- <object data="images/github-mark.svg" type="image/svg+xml"> -->
      <img src="/images/github-mark.svg" class="u-pull-right" style="padding-right:10%"
    alt="Edward on Github" />
    <!-- </object> -->
    </a>
    <div class="row" style="padding-bottom: 5%"> </div>
    </div>
    <div class="nine columns">

<p><span><span>navbar</span></span></p>
<h3 id="classes-of-inference">Classes of Inference</h3>
<p>...</p>
<h3 id="variational-inference-monte-carlo-map">Variational Inference, Monte Carlo, MAP</h3>
<p>We define inference algorithms using classes and class inheritance, where the base class is <code>Inference</code> above.</p>
<p>We take the extreme case of inference where there is always an approximating family, and that inference is about matching two distributions (specifically, two TensorFlow graphs). We must explicitly pass in the random variables in the second graph that infer the random variables in the original graph.</p>
<pre class="python" language="Python"><code>qbeta = RandomVariable()
qz = RandomVariable()
inference = ed.VariationalInference({beta: qbeta, z: qz}, data={x: np.array()})</code></pre>
<p>Inference trains the factors binded to each latent variable. Concretely this means optimizing over TensorFlow variables in both the variational family and the model.</p>
<p>This is also true for methods not typically thought of with an approximating family such as Monte Carlo and MAP. For Monte Carlo, we define an empirical distribution whose parameters are a specified number of samples. For MAP, we define a point mass distribution whose parameters is a single point.</p>
<pre class="python" language="Python"><code>qbeta = Empirical()
qz = Empirical()
inference = ed.MonteCarlo({beta: qbeta, z: qz}, data={x: np.array()})

qbeta = PointMass()
qz = PointMass()
inference = ed.MAP({beta: qbeta, z: qz}, data={x: np.array()})</code></pre>
<h3 id="exact-inference">Exact Inference</h3>
<p>In our general setup, we are simply matching two graphs subject to any constraints. The constraints enable us to perform posterior inference. Matching graphs without the constraints is a form of marginal inference.</p>
<p>Let’s consider inference to get marginal distributions.</p>
<p>Collapsing discrete random variables.</p>
<pre class="python" language="Python"><code>z = Categorical(logits=tf.random_normal([K]))
x = Normal(mu=tf.gather(mus, z), sigma=tf.gather(sigmas, z))

cat = Categorical(logits=tf.Variable(tf.random_normal([K])))
components = [Normal(mu=tf.Variable(tf.random_normal([D])),
                     sigma=tf.Variable(tf.random_normal([D])))
              for _ in K]
qx = Mixture(cat=cat, components=components)

inference = CollapsedInference({x: qx})
inference.run()</code></pre>
<p>TODO has to explicitly define distribution form of each component</p>
<p>Conjugate inference.</p>
<pre class="python" language="Python"><code>z = Gamma(alpha=tf.constant([1]), beta=tf.constant([1./2]))
x = Exponential(lam=z)

qx = Gamma(alpha=tf.Variable(tf.random_normal([1])),
           beta=tf.Variable(tf.random_normal([1])))

inference = ConjugateInference({x: qx})
inference.run()</code></pre>
<p>Symbolic inference.</p>
<pre class="python" language="Python"><code>eps = Normal(mu=tf.constant([0.0]), sigma=tf.constant([1.0]))
x = mu + sigma * eps

qx = Normal(mu=tf.Variable(tf.random_normal([1])),
            sigma=tf.Variable(tf.random_normal([1])))

# using, e.g., Maple
inference = SymbolicInference({x: qx})
inference.run()</code></pre>
<p>TODO has to explicitly define distribution form of posterior functions of rvs</p>
<p>(we can also do deterministic approximations; not sure what’s a better subsection to this)</p>
<p>Numerical integration. This includes for example Riemannian sums, Gaussian quadrature, adaptive quadrature, and quasi-Monte Carlo.</p>
<pre class="python" language="Python"><code>x = Normal(0, 1)
fx = f(x)
# TODO how to represent E_{p(x)} [ f(x) ]?

output = tf.Variable(tf.random_normal(1))

# We want E_{p(x)} [ f(x) ].
inference = GaussianQuadrature({ : output}))
inference.run()</code></pre>
<p><span><span>autogenerated</span></span></p>
    </div>
  </div>
  <div class="row" style="padding-bottom: 25%"> </div>
</div>
<script>
  hljs.initHighlightingOnLoad();
  renderMathInElement(document.body);
</script>
</body>
</html>
