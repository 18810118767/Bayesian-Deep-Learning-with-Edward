<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" http-equiv="Content-Style-Type"/>
<meta content="pandoc" name="generator"/>
<title>Edward – Model</title>
<!-- Mobile Specific Metas -->
<meta content="width=device-width, initial-scale=1" name="viewport">
<!-- FONT -->
<link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700" rel="stylesheet">
<!-- CSS -->
<link href="/css/normalize.css" rel="stylesheet">
<link href="/css/skeleton.css" rel="stylesheet">
<!-- Dynamically resize logo for mobile -->
<style type="text/css">
  .logo-width {
    width: 100%;
    box-sizing: border-box;
    margin-bottom: 15%;
  }
  /* Roughly the point when website is single column */
  @media (max-width: 850px) {
    .logo-width {
      width: 50%;
      box-sizing: border-box;
      margin-bottom: 5%;
    }
  }
  </style>
<!-- KaTeX -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.css" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/contrib/auto-render.min.js"></script>
<!-- highlight.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/highlight.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/github.min.css" rel="stylesheet">
<!-- Favicon -->
<link href="/icons/apple-touch-icon-57x57.png" rel="apple-touch-icon" sizes="57x57">
<link href="/icons/apple-touch-icon-60x60.png" rel="apple-touch-icon" sizes="60x60">
<link href="/icons/apple-touch-icon-72x72.png" rel="apple-touch-icon" sizes="72x72">
<link href="/icons/apple-touch-icon-76x76.png" rel="apple-touch-icon" sizes="76x76">
<link href="/icons/apple-touch-icon-114x114.png" rel="apple-touch-icon" sizes="114x114">
<link href="/icons/apple-touch-icon-120x120.png" rel="apple-touch-icon" sizes="120x120">
<link href="/icons/apple-touch-icon-144x144.png" rel="apple-touch-icon" sizes="144x144">
<link href="/icons/apple-touch-icon-152x152.png" rel="apple-touch-icon" sizes="152x152">
<link href="/icons/apple-touch-icon-180x180.png" rel="apple-touch-icon" sizes="180x180">
<link href="/icons/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="/icons/android-chrome-192x192.png" rel="icon" sizes="192x192" type="image/png">
<link href="/icons/favicon-96x96.png" rel="icon" sizes="96x96" type="image/png">
<link href="/icons/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="/icons/manifest.json" rel="manifest">
<link color="#5bbad5" href="/icons/safari-pinned-tab.svg" rel="mask-icon">
<link href="/icons/favicon.ico" rel="shortcut icon">
<meta content="#da532c" name="msapplication-TileColor">
<meta content="/icons/mstile-144x144.png" name="msapplication-TileImage">
<meta content="/icons/browserconfig.xml" name="msapplication-config">
<meta content="#ffffff" name="theme-color">
</meta></meta></meta></meta></link></link></link></link></link></link></link></link></link></link></link></link></link></link></link></link></link></link></link></link></meta></head>
<body>
<div class="container">
<div class="row" style="margin-top: 5%">
<div class="three columns">
<h1><a href="/">Edward</a></h1>
<a href="/">
<center>
<img alt="Edward" class="logo-width" src="/images/edward.png"/>
</center>
</a>
<a class="button u-full-width" href="/">Home</a>
<a class="button u-full-width" href="/getting-started">Getting Started</a>
<a class="button u-full-width" href="/tutorials/">Tutorials</a>
<a class="button u-full-width" href="/api/">API</a>
<a class="button u-full-width" href="#">Advanced</a>
<a class="button2 u-full-width" href="/design-philosophy">Design Philosophy</a>
<a class="button2 u-full-width" href="/contributing">Contributing</a>
<a class="button2 u-full-width" href="/troubleshooting">Troubleshooting</a>
<a class="button2 u-full-width" href="/license">License</a>
<div class="row" style="padding-bottom: 5%"> </div>
<a href="https://github.com/blei-lab/edward">
<!-- <object data="images/github-mark.svg" type="image/svg+xml"> -->
<img alt="Edward on Github" class="u-pull-right" src="/images/github-mark.svg" style="padding-right:10%"/>
<!-- </object> -->
</a>
<div class="row" style="padding-bottom: 5%"> </div>
</div>
<div class="nine columns">
<h2 id="api-and-documentation">API and Documentation</h2>
<div class="row" style="padding-bottom: 5%">
<div class="row" style="padding-bottom: 1%">
<a class="button3" href="/api/data">Data</a>
<a class="button3 button-primary" href="/api/model">Model</a>
<a class="button3" href="/api/inference">Inference</a>
<a class="button3" href="/api/criticism">Criticism</a>
</div>
<div class="row">
<a class="button4" href="/api/model-compositionality">Compositionality</a>
<a class="button4" href="/api/model-wrappers">Wrappers</a>
</div>
</div>
<h3 id="model">Model</h3>
<p>A probabilistic model is a joint distribution <span class="math inline">\(p(\mathbf{x},
\mathbf{z})\)</span> of data <span class="math inline">\(\mathbf{x}\)</span> and latent variables <span class="math inline">\(\mathbf{z}\)</span>. For background, see the <a href="/tutorials/model">Probability Models tutorial</a>.</p>
<p>In Edward, we specify models using a simple language of random variables. A random variable <span class="math inline">\(\mathbf{x}\)</span> is an object parameterized by tensors <span class="math inline">\(\theta^*\)</span>, where the number of random variables in one object is determined by the dimensions of its parameters.</p>
<pre class="python" language="Python"><code>from edward.models import Normal, Exponential

# univariate normal
Normal(mu=tf.constant(0.0), sigma=tf.constant(1.0))
# vector of 5 univariate normals
Normal(mu=tf.zeros(5), sigma=tf.ones(5))
# 2 x 3 matrix of Exponentials
Exponential(lam=tf.ones([2, 3]))</code></pre>
<p>For multivariate distributions, the multivariate dimension is the innermost (right-most) dimension of the parameters.</p>
<pre class="python" language="Python"><code>from edward.models import Dirichlet, MultivariateNormalFull

# K-dimensional Dirichlet
Dirichlet(alpha=tf.constant([0.1] * K)
# vector of 5 K-dimensional multivariate normals
MultivariateNormalFull(mu=tf.zeros([5, K]), sigma=...)
# 2 x 5 matrix of K-dimensional multivariate normals
MultivariateNormalFull(mu=tf.zeros([2, 5, K]), sigma=...)</code></pre>
<p>Random variables are equipped with methods such as <code>log_prob()</code>, <span class="math inline">\(\log p(\mathbf{x}\mid\theta^*)\)</span>, <code>mean()</code>, <span class="math inline">\(\mathbb{E}_{p(\mathbf{x}\mid\theta^*)}[\mathbf{x}]\)</span>, and <code>sample()</code>, <span class="math inline">\(\mathbf{x}^*\sim p(\mathbf{x}\mid\theta^*)\)</span>. Further, each random variable is associated to a tensor <span class="math inline">\(\mathbf{x}^*\)</span> in the computational graph, which represents a single sample <span class="math inline">\(\mathbf{x}^*\sim
p(\mathbf{x}\mid\theta^*)\)</span>.</p>
<p>This makes it easy to parameterize random variables with complex deterministic structure, such as with deep neural networks, a diverse set of math operations, and compatibility with third party libraries which also build on TensorFlow. The design also enables compositions of random variables to capture complex stochastic structure. They operate on <span class="math inline">\(\mathbf{x}^*\)</span>.</p>
<p><img alt="image" src="/images/random_variable_ops.png" width="375"/></p>
<pre class="python" language="Python"><code>from edward.models import Normal

x = Normal(mu=tf.zeros(10), sigma=tf.ones(10))
y = tf.constant(5.0)
x + y, x - y, x * y, x / y
tf.tanh(x * y)
tf.gather(x, 2)  # 3rd normal rv in the vector</code></pre>
<p>In the <a href="/api/model-compositionality">compositionality page</a>, we describe how to build models by composing random variables.</p>
<hr/>
<p>For a list of random variables supported in Edward, see the <a href="https://www.tensorflow.org/versions/master/api_docs/python/contrib.distributions.html">TensorFlow distributions API</a>. Edward random variables build on top of them, inheriting the same arguments and class methods. Additional methods are also available, detailed below.</p>
<dl class="class">
<dt id="edward.models.RandomVariable">
<em class="property">class </em><code class="descclassname">edward.models.</code><code class="descname">RandomVariable</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variable.py#L10" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Base class for random variables.</p>
<p>A random variable is an object parameterized by tensors. It is
equipped with methods such as the log-density, mean, and sample.</p>
<p>It also wraps a tensor, where the tensor corresponds to a sample
from the random variable. This enables operations on the TensorFlow
graph, allowing random variables to be used in conjunction with
other TensorFlow ops.</p>
<p class="rubric">Notes</p>
<p><code class="docutils literal"><span class="pre">RandomVariable</span></code> assumes use in a multiple inheritance setting. The
child class must first inherit <code class="docutils literal"><span class="pre">RandomVariable</span></code>, then second inherit a
class in <code class="docutils literal"><span class="pre">tf.contrib.distributions</span></code>. With Python’s method resolution
order, this implies the following during initialization (using
<code class="docutils literal"><span class="pre">distributions.Bernoulli</span></code> as an example):</p>
<ol class="arabic simple">
<li>Start the <code class="docutils literal"><span class="pre">__init__()</span></code> of the child class, which passes all
<code class="docutils literal"><span class="pre">*args,</span> <span class="pre">**kwargs</span></code> to <code class="docutils literal"><span class="pre">RandomVariable</span></code>.</li>
<li>This in turn passes all <code class="docutils literal"><span class="pre">*args,</span> <span class="pre">**kwargs</span></code> to
<code class="docutils literal"><span class="pre">distributions.Bernoulli</span></code>, completing the <code class="docutils literal"><span class="pre">__init__()</span></code> of
<code class="docutils literal"><span class="pre">distributions.Bernoulli</span></code>.</li>
<li>Complete the <code class="docutils literal"><span class="pre">__init__()</span></code> of <code class="docutils literal"><span class="pre">RandomVariable</span></code>, which calls</li>
</ol>
<blockquote>
<div><code class="docutils literal"><span class="pre">self.sample()</span></code>, relying on the method from
<code class="docutils literal"><span class="pre">distributions.Bernoulli</span></code>.</div></blockquote>
<ol class="arabic simple" start="4">
<li>Complete the <code class="docutils literal"><span class="pre">__init__()</span></code> of the child class.</li>
</ol>
<p>Methods from both <code class="docutils literal"><span class="pre">RandomVariable</span></code> and <code class="docutils literal"><span class="pre">distributions.Bernoulli</span></code>
populate the namespace of the child class. Methods from
<code class="docutils literal"><span class="pre">RandomVariable</span></code> will take higher priority if there are conflicts.</p>
<p class="rubric">Examples</p>
<pre class="python" language="Python"><code>&gt;&gt;&gt; p = tf.constant(0.5)
&gt;&gt;&gt; x = Bernoulli(p=p)
&gt;&gt;&gt;
&gt;&gt;&gt; z1 = tf.constant([[2.0, 8.0]])
&gt;&gt;&gt; z2 = tf.constant([[1.0, 2.0]])
&gt;&gt;&gt; x = Bernoulli(p=tf.matmul(z1, z2))
&gt;&gt;&gt;
&gt;&gt;&gt; mu = Normal(mu=tf.constant(0.0), sigma=tf.constant(1.0))
&gt;&gt;&gt; x = Normal(mu=mu, sigma=tf.constant(1.0))

</code>
</pre>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="edward.models.RandomVariable.value">
<code class="descname">value</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variable.py#L91" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Get tensor that the random variable corresponds to.</p>
</dd></dl>
<dl class="method">
<dt id="edward.models.RandomVariable.get_ancestors">
<code class="descname">get_ancestors</code><span class="sig-paren">(</span><em>collection=None</em><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variable.py#L95" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Get ancestor random variables.</p>
</dd></dl>
<dl class="method">
<dt id="edward.models.RandomVariable.get_children">
<code class="descname">get_children</code><span class="sig-paren">(</span><em>collection=None</em><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variable.py#L100" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Get child random variables.</p>
</dd></dl>
<dl class="method">
<dt id="edward.models.RandomVariable.get_descendants">
<code class="descname">get_descendants</code><span class="sig-paren">(</span><em>collection=None</em><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variable.py#L105" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Get descendant random variables.</p>
</dd></dl>
<dl class="method">
<dt id="edward.models.RandomVariable.get_parents">
<code class="descname">get_parents</code><span class="sig-paren">(</span><em>collection=None</em><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variable.py#L110" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Get parent random variables.</p>
</dd></dl>
<dl class="method">
<dt id="edward.models.RandomVariable.get_siblings">
<code class="descname">get_siblings</code><span class="sig-paren">(</span><em>collection=None</em><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variable.py#L115" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Get sibling random variables.</p>
</dd></dl>
<dl class="method">
<dt id="edward.models.RandomVariable.get_variables">
<code class="descname">get_variables</code><span class="sig-paren">(</span><em>collection=None</em><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variable.py#L120" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Get TensorFlow variables that the random variable depends on.</p>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="edward.models.Empirical">
<em class="property">class </em><code class="descclassname">edward.models.</code><code class="descname">Empirical</code><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variables.py#L14" title="Link to definition on GitHub.">[source]</a></dt>
<dd></dd></dl>
<dl class="class">
<dt id="edward.models.PointMass">
<em class="property">class </em><code class="descclassname">edward.models.</code><code class="descname">PointMass</code><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variables.py#L19" title="Link to definition on GitHub.">[source]</a></dt>
<dd></dd></dl>
</div>
</div>
<div class="row" style="padding-bottom: 25%"> </div>
</div>
<script>
  hljs.initHighlightingOnLoad();
  renderMathInElement(document.body);
</script>
</body>
</html>
