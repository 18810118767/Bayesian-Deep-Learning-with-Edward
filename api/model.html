<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<meta content="text/css" http-equiv="Content-Style-Type"/>
<meta content="pandoc" name="generator"/>
<title>Edward – Model</title>
<!-- Mobile Specific Metas -->
<meta content="width=device-width, initial-scale=1" name="viewport">
<!-- FONT -->
<link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700" rel="stylesheet">
<!-- CSS -->
<link href="/css/normalize.css" rel="stylesheet">
<link href="/css/skeleton.css" rel="stylesheet">
<!-- Dynamically resize logo for mobile -->
<style type="text/css">
  .logo-width {
    width: 100%;
    box-sizing: border-box;
    margin-bottom: 15%;
  }
  /* Roughly the point when website is single column */
  @media (max-width: 850px) {
    .logo-width {
      width: 50%;
      box-sizing: border-box;
      margin-bottom: 5%;
    }
  }
  /* Docstrings. */
  dl.class + dl.class, dl.function + dl.function {
    /* Add border inbetween docstrings. */
    border-top: 1px solid #E1E1E1;
  }
  dt { /* Add spacing for top border. */
    margin-top: 1.0rem;
  }
  dd { /* Remove overall indenting in an entry. */
    margin-left: 0.0rem;
  }
  dl th, dl td { /* Remove extraneous padding and decorations. */
    padding: 0 15px 0 0;
    border: none;
  }
  dt em, dt span.sig-paren { /* Keep style of declarations consistent. */
    font-family: monospace, monospace;
    font-style: normal;
    font-size: 14px !important;
  }
  /* Attribute contents within a docstring. */
  dd blockquote, dl blockquote, dt blockquote { /* Reduce margins. */
    margin-left: 0.0rem;
    margin-top: 0.0rem;
    margin-bottom: 0.0rem;
  }
  dl td p { /* Reduce spacing. */
    margin-bottom: 0.75rem;
  }
  dl td.field-body { /* Add indenting. */
    padding-top: 0.75rem;
    padding-left: 2.0rem;
    display: block;
  }
  dl code { /* Keep code font size consistent with rest of contents. */
    font-size: 90%;
  }
  </style>
<!-- KaTeX -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/katex.min.css" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.6.0/contrib/auto-render.min.js"></script>
<!-- highlight.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/highlight.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/github.min.css" rel="stylesheet">
<!-- Favicon -->
<link href="/icons/apple-touch-icon-57x57.png" rel="apple-touch-icon" sizes="57x57">
<link href="/icons/apple-touch-icon-60x60.png" rel="apple-touch-icon" sizes="60x60">
<link href="/icons/apple-touch-icon-72x72.png" rel="apple-touch-icon" sizes="72x72">
<link href="/icons/apple-touch-icon-76x76.png" rel="apple-touch-icon" sizes="76x76">
<link href="/icons/apple-touch-icon-114x114.png" rel="apple-touch-icon" sizes="114x114">
<link href="/icons/apple-touch-icon-120x120.png" rel="apple-touch-icon" sizes="120x120">
<link href="/icons/apple-touch-icon-144x144.png" rel="apple-touch-icon" sizes="144x144">
<link href="/icons/apple-touch-icon-152x152.png" rel="apple-touch-icon" sizes="152x152">
<link href="/icons/apple-touch-icon-180x180.png" rel="apple-touch-icon" sizes="180x180">
<link href="/icons/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="/icons/android-chrome-192x192.png" rel="icon" sizes="192x192" type="image/png">
<link href="/icons/favicon-96x96.png" rel="icon" sizes="96x96" type="image/png">
<link href="/icons/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="/icons/manifest.json" rel="manifest">
<link color="#5bbad5" href="/icons/safari-pinned-tab.svg" rel="mask-icon">
<link href="/icons/favicon.ico" rel="shortcut icon">
<meta content="#da532c" name="msapplication-TileColor">
<meta content="/icons/mstile-144x144.png" name="msapplication-TileImage">
<meta content="/icons/browserconfig.xml" name="msapplication-config">
<meta content="#ffffff" name="theme-color">
</meta></meta></meta></meta></link></link></link></link></link></link></link></link></link></link></link></link></link></link></link></link></link></link></link></link></meta></head>
<body>
<div class="container">
<div class="row" style="margin-top: 5%">
<div class="three columns">
<h1><a href="/">Edward</a></h1>
<a href="/">
<center>
<img alt="Edward" class="logo-width" src="/images/edward.png"/>
</center>
</a>
<a class="button u-full-width" href="/getting-started">Getting Started</a>
<a class="button u-full-width" href="/tutorials/">Tutorials</a>
<a class="button u-full-width" href="/api/">API</a>
<a class="button u-full-width" href="/community">Community</a>
<a class="button u-full-width" href="/contributing">Contributing</a>
<div class="row" style="padding-bottom: 5%"> </div>
<a class="button2 u-pull-right" href="https://github.com/blei-lab/edward" style="padding-right:10%">
<span style="vertical-align:middle;">Github</span> 
      <img alt="Edward on Github" src="/images/github-mark.svg" style="vertical-align:middle;"/>
</a>
<div class="row" style="padding-bottom: 5%"> </div>
</div>
<div class="nine columns">
<h2 id="api-and-documentation">API and Documentation</h2>
<div class="row" style="padding-bottom: 5%">
<div class="row" style="padding-bottom: 1%">
<a class="button3" href="/api/data">Data</a>
<a class="button3 button-primary" href="/api/model">Model</a>
<a class="button3" href="/api/inference">Inference</a>
<a class="button3" href="/api/criticism">Criticism</a>
<a class="button3" href="/api/reference">Reference</a>
</div>
<div class="row">
<a class="button4" href="/api/model-compositionality">Compositionality</a>
<a class="button4" href="/api/model-development">Development</a>
</div>
</div>
<h3 id="model">Model</h3>
<p>A probabilistic model is a joint distribution <span class="math inline">\(p(\mathbf{x},
\mathbf{z})\)</span> of data <span class="math inline">\(\mathbf{x}\)</span> and latent variables <span class="math inline">\(\mathbf{z}\)</span>. For background, see the <a href="/tutorials/model">Probabilistic Models tutorial</a>.</p>
<p>In Edward, we specify models using a simple language of random variables. A random variable <span class="math inline">\(\mathbf{x}\)</span> is an object parameterized by tensors <span class="math inline">\(\theta^*\)</span>, where the number of random variables in one object is determined by the dimensions of its parameters.</p>
<pre class="python" language="Python"><code>from edward.models import Normal, Exponential

# univariate normal
Normal(mu=tf.constant(0.0), sigma=tf.constant(1.0))
# vector of 5 univariate normals
Normal(mu=tf.zeros(5), sigma=tf.ones(5))
# 2 x 3 matrix of Exponentials
Exponential(lam=tf.ones([2, 3]))</code></pre>
<p>For multivariate distributions, the multivariate dimension is the innermost (right-most) dimension of the parameters.</p>
<pre class="python" language="Python"><code>from edward.models import Dirichlet, MultivariateNormalFull

# K-dimensional Dirichlet
Dirichlet(alpha=tf.constant([0.1] * K))
# vector of 5 K-dimensional multivariate normals
MultivariateNormalFull(mu=tf.zeros([5, K]), sigma=tf.ones([5, K, K]))
# 2 x 5 matrix of K-dimensional multivariate normals
MultivariateNormalFull(mu=tf.zeros([2, 5, K]), sigma=tf.ones([2, 5, K, K]))</code></pre>
<p>Random variables are equipped with methods such as <code>log_prob()</code>, <span class="math inline">\(\log p(\mathbf{x}\mid\theta^*)\)</span>, <code>mean()</code>, <span class="math inline">\(\mathbb{E}_{p(\mathbf{x}\mid\theta^*)}[\mathbf{x}]\)</span>, and <code>sample()</code>, <span class="math inline">\(\mathbf{x}^*\sim p(\mathbf{x}\mid\theta^*)\)</span>. Further, each random variable is associated to a tensor <span class="math inline">\(\mathbf{x}^*\)</span> in the computational graph, which represents a single sample <span class="math inline">\(\mathbf{x}^*\sim
p(\mathbf{x}\mid\theta^*)\)</span>.</p>
<p>This makes it easy to parameterize random variables with complex deterministic structure, such as with deep neural networks, a diverse set of math operations, and compatibility with third party libraries which also build on TensorFlow. The design also enables compositions of random variables to capture complex stochastic structure. They operate on <span class="math inline">\(\mathbf{x}^*\)</span>.</p>
<p><img alt="image" src="/images/random_variable_ops.png" width="375"/></p>
<pre class="python" language="Python"><code>from edward.models import Normal

x = Normal(mu=tf.zeros(10), sigma=tf.ones(10))
y = tf.constant(5.0)
x + y, x - y, x * y, x / y
tf.tanh(x * y)
x[2]  # 3rd normal rv in the vector</code></pre>
<p>In the <a href="/api/model-compositionality">compositionality page</a>, we describe how to build models by composing random variables.</p>
<hr/>
<p>For a list of random variables supported in Edward, see the <a href="/api/reference">API reference page</a>. Edward random variables build on top of them, inheriting the same arguments and class methods. Additional methods are also available, detailed below.</p>
<dl class="class">
<dt id="edward.models.RandomVariable">
<em class="property">class </em><code class="descclassname">edward.models.</code><code class="descname">RandomVariable</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variable.py#L16" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Base class for random variables.</p>
<p>A random variable is an object parameterized by tensors. It is
equipped with methods such as the log-density, mean, and sample.</p>
<p>It also wraps a tensor, where the tensor corresponds to a sample
from the random variable. This enables operations on the TensorFlow
graph, allowing random variables to be used in conjunction with
other TensorFlow ops.</p>
<p class="rubric">Notes</p>
<p><code class="docutils literal"><span class="pre">RandomVariable</span></code> assumes use in a multiple inheritance setting. The
child class must first inherit <code class="docutils literal"><span class="pre">RandomVariable</span></code>, then second inherit a
class in <code class="docutils literal"><span class="pre">tf.contrib.distributions</span></code>. With Python’s method resolution
order, this implies the following during initialization (using
<code class="docutils literal"><span class="pre">distributions.Bernoulli</span></code> as an example):</p>
<ol class="arabic simple">
<li>Start the <code class="docutils literal"><span class="pre">__init__()</span></code> of the child class, which passes all
<code class="docutils literal"><span class="pre">*args,</span> <span class="pre">**kwargs</span></code> to <code class="docutils literal"><span class="pre">RandomVariable</span></code>.</li>
<li>This in turn passes all <code class="docutils literal"><span class="pre">*args,</span> <span class="pre">**kwargs</span></code> to
<code class="docutils literal"><span class="pre">distributions.Bernoulli</span></code>, completing the <code class="docutils literal"><span class="pre">__init__()</span></code> of
<code class="docutils literal"><span class="pre">distributions.Bernoulli</span></code>.</li>
<li>Complete the <code class="docutils literal"><span class="pre">__init__()</span></code> of <code class="docutils literal"><span class="pre">RandomVariable</span></code>, which calls
<code class="docutils literal"><span class="pre">self.sample()</span></code>, relying on the method from
<code class="docutils literal"><span class="pre">distributions.Bernoulli</span></code>.</li>
<li>Complete the <code class="docutils literal"><span class="pre">__init__()</span></code> of the child class.</li>
</ol>
<p>Methods from both <code class="docutils literal"><span class="pre">RandomVariable</span></code> and <code class="docutils literal"><span class="pre">distributions.Bernoulli</span></code>
populate the namespace of the child class. Methods from
<code class="docutils literal"><span class="pre">RandomVariable</span></code> will take higher priority if there are conflicts.</p>
<p class="rubric">Examples</p>
<pre class="python" language="Python"><code>p = tf.constant(0.5)
x = Bernoulli(p=p)

z1 = tf.constant([[2.0, 8.0]])
z2 = tf.constant([[1.0, 2.0]])
x = Bernoulli(p=tf.matmul(z1, z2))

mu = Normal(mu=tf.constant(0.0), sigma=tf.constant(1.0))
x = Normal(mu=mu, sigma=tf.constant(1.0))
</code>
</pre>
<p class="rubric">Attributes</p>
<p class="rubric">Methods</p>
<dl class="attribute">
<dt id="edward.models.RandomVariable.shape">
<code class="descname">shape</code><a class="headerlink" href="" title="Permalink to this definition"></a></dt>
<dd><p>Shape of random variable.</p>
</dd></dl>
<dl class="method">
<dt id="edward.models.RandomVariable.eval">
<code class="descname">eval</code><span class="sig-paren">(</span><em>session=None</em>, <em>feed_dict=None</em><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variable.py#L226" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>In a session, computes and returns the value of this random variable.</p>
<p>This is not a graph construction method, it does not add ops to the graph.</p>
<p>This convenience method requires a session where the graph
containing this variable has been launched. If no session is
passed, the default session is used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"></col>
<col class="field-body"></col>
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th></tr><tr class="field-odd field"><td class="field-body"><p class="first"><strong>session</strong> : tf.BaseSession, optional</p>
<blockquote>
<div><p>The <code class="docutils literal"><span class="pre">tf.Session</span></code> to use to evaluate this random variable. If
none, the default session is used.</p>
</div></blockquote>
<p><strong>feed_dict</strong> : dict, optional</p>
<blockquote class="last">
<div><p>A dictionary that maps <code class="docutils literal"><span class="pre">tf.Tensor</span></code> objects to feed values. See
<code class="docutils literal"><span class="pre">tf.Session.run()</span></code> for a description of the valid feed values.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<pre class="python" language="Python"><code>x = Normal(0.0, 1.0)
with tf.Session() as sess:
  # Usage passing the session explicitly.
  print(x.eval(sess))
  # Usage with the default session.  The 'with' block
  # above makes 'sess' the default session.
  print(x.eval())
</code>
</pre>
</dd></dl>
<dl class="method">
<dt id="edward.models.RandomVariable.value">
<code class="descname">value</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variable.py#L256" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Get tensor that the random variable corresponds to.</p>
</dd></dl>
<dl class="method">
<dt id="edward.models.RandomVariable.get_ancestors">
<code class="descname">get_ancestors</code><span class="sig-paren">(</span><em>collection=None</em><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variable.py#L260" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Get ancestor random variables.</p>
</dd></dl>
<dl class="method">
<dt id="edward.models.RandomVariable.get_children">
<code class="descname">get_children</code><span class="sig-paren">(</span><em>collection=None</em><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variable.py#L265" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Get child random variables.</p>
</dd></dl>
<dl class="method">
<dt id="edward.models.RandomVariable.get_descendants">
<code class="descname">get_descendants</code><span class="sig-paren">(</span><em>collection=None</em><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variable.py#L270" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Get descendant random variables.</p>
</dd></dl>
<dl class="method">
<dt id="edward.models.RandomVariable.get_parents">
<code class="descname">get_parents</code><span class="sig-paren">(</span><em>collection=None</em><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variable.py#L275" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Get parent random variables.</p>
</dd></dl>
<dl class="method">
<dt id="edward.models.RandomVariable.get_siblings">
<code class="descname">get_siblings</code><span class="sig-paren">(</span><em>collection=None</em><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variable.py#L280" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Get sibling random variables.</p>
</dd></dl>
<dl class="method">
<dt id="edward.models.RandomVariable.get_variables">
<code class="descname">get_variables</code><span class="sig-paren">(</span><em>collection=None</em><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variable.py#L285" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Get TensorFlow variables that the random variable depends on.</p>
</dd></dl>
<dl class="method">
<dt id="edward.models.RandomVariable.get_shape">
<code class="descname">get_shape</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/random_variable.py#L290" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Get shape of random variable.</p>
</dd></dl>
</dd></dl>
<dl class="class">
<dt id="edward.models.DirichletProcess">
<em class="property">class </em><code class="descclassname">edward.models.</code><code class="descname">DirichletProcess</code><span class="sig-paren">(</span><em>alpha</em>, <em>base</em>, <em>validate_args=False</em>, <em>allow_nan_stats=True</em>, <em>name='DirichletProcess'</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/dirichlet_process.py#L16" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Dirichlet process <span class="math">\(\mathcal{DP}(\alpha, H)\)</span>.</p>
<p>It has two parameters: a positive real value <span class="math">\(\alpha\)</span>,
known as the concentration parameter (<code class="docutils literal"><span class="pre">alpha</span></code>), and a base
distribution <span class="math">\(H\)</span> (<code class="docutils literal"><span class="pre">base</span></code>).</p>
<p class="rubric">Attributes</p>
<p class="rubric">Methods</p>
<p>Initialize a batch of Dirichlet processes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"></col>
<col class="field-body"></col>
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th></tr><tr class="field-odd field"><td class="field-body"><p class="first"><strong>alpha</strong> : tf.Tensor</p>
<blockquote>
<div><p>Concentration parameter. Must be positive real-valued. Its shape
determines the number of independent DPs (batch shape).</p>
</div></blockquote>
<p><strong>base</strong> : RandomVariable</p>
<blockquote class="last">
<div><p>Base distribution. Its shape determines the shape of an
individual DP (event shape).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<pre class="python" language="Python"><code># scalar concentration parameter, scalar base distribution
dp = DirichletProcess(0.1, Normal(mu=0.0, sigma=1.0))
assert dp.shape == ()

# vector of concentration parameters, matrix of Exponentials
dp = DirichletProcess(tf.constant([0.1, 0.4]),
                      Exponential(lam=tf.ones([5, 3])))
assert dp.shape == (2, 5, 3)
</code>
</pre>
<p class="rubric">Attributes</p>
</dd></dl>
<dl class="class">
<dt id="edward.models.Empirical">
<em class="property">class </em><code class="descclassname">edward.models.</code><code class="descname">Empirical</code><span class="sig-paren">(</span><em>params</em>, <em>validate_args=False</em>, <em>allow_nan_stats=True</em>, <em>name='Empirical'</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/empirical.py#L11" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>Empirical random variable.</p>
<p class="rubric">Attributes</p>
<p class="rubric">Methods</p>
<p>Initialize an <code class="docutils literal"><span class="pre">Empirical</span></code> random variable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"></col>
<col class="field-body"></col>
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th></tr><tr class="field-odd field"><td class="field-body"><p class="first"><strong>params</strong> : tf.Tensor</p>
<blockquote class="last">
<div><p>Collection of samples. Its outer (left-most) dimension
determines the number of samples.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<pre class="python" language="Python"><code># 100 samples of a scalar
x = Empirical(params=tf.zeros(100))
assert x.shape == ()

# 5 samples of a 2 x 3 matrix
dp = Empirical(params=tf.zeros([5, 2, 3]))
assert x.shape == (2, 3)
</code>
</pre>
<p class="rubric">Attributes</p>
</dd></dl>
<dl class="class">
<dt id="edward.models.PointMass">
<em class="property">class </em><code class="descclassname">edward.models.</code><code class="descname">PointMass</code><span class="sig-paren">(</span><em>params</em>, <em>validate_args=False</em>, <em>allow_nan_stats=True</em>, <em>name='PointMass'</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="u-pull-right" href="https://github.com/blei-lab/edward/blob/master/edward/models/point_mass.py#L11" title="Link to definition on GitHub.">[source]</a></dt>
<dd><p>PointMass random variable.</p>
<p>It is analogous to an Empirical random variable with one sample, but
its parameter argument does not have an outer dimension.</p>
<p class="rubric">Attributes</p>
<p class="rubric">Methods</p>
<p>Initialize a <code class="docutils literal"><span class="pre">PointMass</span></code> random variable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name"></col>
<col class="field-body"></col>
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th></tr><tr class="field-odd field"><td class="field-body"><p class="first"><strong>params</strong> : tf.Tensor</p>
<blockquote class="last">
<div><p>The location with all probability mass.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<pre class="python" language="Python"><code># scalar
x = PointMass(params=28.3)
assert x.shape == ()

# 5 x 2 x 3 tensor
dp = PointMass(params=tf.zeros([5, 2, 3]))
assert x.shape == (5, 2, 3)
</code>
</pre>
<p class="rubric">Attributes</p>
</dd></dl>
</div>
</div>
<div class="row" style="padding-bottom: 25%"> </div>
</div>
<script>
  hljs.initHighlightingOnLoad();
  renderMathInElement(document.body);
</script>
</body>
</html>
