

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>edward.inferences.monte_carlo module &mdash; Edward 1.0.9 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Edward 1.0.9 documentation" href="index.html"/>
        <link rel="up" title="edward.inferences package" href="edward.inferences.html"/>
        <link rel="next" title="edward.inferences.variational_inference module" href="edward.inferences.variational_inference.html"/>
        <link rel="prev" title="edward.inferences.metropolis_hastings module" href="edward.inferences.metropolis_hastings.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Edward
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="inferences.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="criticisms.html">Criticism</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="edward.html">edward package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="edward.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="edward.criticisms.html">edward.criticisms package</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="edward.inferences.html">edward.inferences package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="edward.inferences.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="edward.models.html">edward.models package</a></li>
<li class="toctree-l3"><a class="reference internal" href="edward.stats.html">edward.stats package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="edward.html#submodules">Submodules</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Edward</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="edward.html">edward package</a> &raquo;</li>
      
          <li><a href="edward.inferences.html">edward.inferences package</a> &raquo;</li>
      
    <li>edward.inferences.monte_carlo module</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/edward.inferences.monte_carlo.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-edward.inferences.monte_carlo">
<span id="edward-inferences-monte-carlo-module"></span><h1>edward.inferences.monte_carlo module<a class="headerlink" href="#module-edward.inferences.monte_carlo" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="edward.inferences.monte_carlo.MonteCarlo">
<em class="property">class </em><code class="descclassname">edward.inferences.monte_carlo.</code><code class="descname">MonteCarlo</code><span class="sig-paren">(</span><em>latent_vars</em>, <em>data=None</em>, <em>model_wrapper=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/edward/inferences/monte_carlo.html#MonteCarlo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#edward.inferences.monte_carlo.MonteCarlo" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="edward.inferences.inference.html#edward.inferences.inference.Inference" title="edward.inferences.inference.Inference"><code class="xref py py-class docutils literal"><span class="pre">edward.inferences.inference.Inference</span></code></a></p>
<p>Base class for Monte Carlo inference methods.</p>
<p>Initialization.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>latent_vars</strong> (<em>list of RandomVariable or</em>) &#8211; dict of RandomVariable to RandomVariable
Collection of random variables to perform inference on. If
list, each random variable will be implictly approximated
using a <code class="docutils literal"><span class="pre">Empirical</span></code> random variable that is defined
internally (with support matching each random variable).
If dictionary, each random variable must be a <code class="docutils literal"><span class="pre">Empirical</span></code>
random variable.</li>
<li><strong>data</strong> (<em>dict, optional</em>) &#8211; Data dictionary which binds observed variables (of type
<cite>RandomVariable</cite>) to their realizations (of type <cite>tf.Tensor</cite>).
It can also bind placeholders (of type <cite>tf.Tensor</cite>) used in the
model to their realizations.</li>
<li><strong>model_wrapper</strong> (<em>ed.Model, optional</em>) &#8211; A wrapper for the probability model. If specified, the random
variables in <cite>latent_vars</cite>&#8216; dictionary keys are strings used
accordingly by the wrapper. <cite>data</cite> is also changed. For
TensorFlow, Python, and Stan models, the key type is a string;
for PyMC3, the key type is a Theano shared variable. For
TensorFlow, Python, and PyMC3 models, the value type is a NumPy
array or TensorFlow tensor; for Stan, the value type is the
type according to the Stan program&#8217;s data block.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Most explicitly, MonteCarlo is specified via a dictionary:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">qpi</span> <span class="o">=</span> <span class="n">Empirical</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">T</span><span class="p">,</span> <span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">])))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmu</span> <span class="o">=</span> <span class="n">Empirical</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">T</span><span class="p">,</span> <span class="n">K</span><span class="o">*</span><span class="n">D</span><span class="p">])))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qsigma</span> <span class="o">=</span> <span class="n">Empirical</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">T</span><span class="p">,</span> <span class="n">K</span><span class="o">*</span><span class="n">D</span><span class="p">])))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MonteCarlo</span><span class="p">({</span><span class="n">pi</span><span class="p">:</span> <span class="n">qpi</span><span class="p">,</span> <span class="n">mu</span><span class="p">:</span> <span class="n">qmu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">:</span> <span class="n">qsigma</span><span class="p">},</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>The inferred posterior is comprised of <code class="docutils literal"><span class="pre">Empirical</span></code> random
variables with <code class="docutils literal"><span class="pre">T</span></code> samples. We also automate the specification
of <code class="docutils literal"><span class="pre">Empirical</span></code> random variables. One can pass in a list of
latent variables instead:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MonteCarlo</span><span class="p">([</span><span class="n">beta</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MonteCarlo</span><span class="p">([</span><span class="n">pi</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>It defaults to Empirical random variables with 10,000 samples for
each dimension. However, for model wrappers, lists are not
supported, e.g.,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MonteCarlo</span><span class="p">([</span><span class="s1">&#39;z&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">,</span> <span class="n">model_wrapper</span><span class="p">)</span>
</pre></div>
</div>
<p>This is because internally with model wrappers, we have no way of
knowing the dimensions in which to infer each latent variable. One
must explicitly pass in the Empirical random variables.</p>
<p class="rubric">Notes</p>
<p>The number of Monte Carlo iterations is set according to the
minimum of all Empirical sizes.</p>
<dl class="method">
<dt id="edward.inferences.monte_carlo.MonteCarlo.build_update">
<code class="descname">build_update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/edward/inferences/monte_carlo.html#MonteCarlo.build_update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#edward.inferences.monte_carlo.MonteCarlo.build_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Build update, which returns an assign op for parameters in
the Empirical random variables.</p>
<p>Any derived class of <code class="docutils literal"><span class="pre">MonteCarlo</span></code> <strong>must</strong> implement
this method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal"><span class="pre">NotImplementedError</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="edward.inferences.monte_carlo.MonteCarlo.initialize">
<code class="descname">initialize</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/edward/inferences/monte_carlo.html#MonteCarlo.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#edward.inferences.monte_carlo.MonteCarlo.initialize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="edward.inferences.monte_carlo.MonteCarlo.print_progress">
<code class="descname">print_progress</code><span class="sig-paren">(</span><em>info_dict</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/edward/inferences/monte_carlo.html#MonteCarlo.print_progress"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#edward.inferences.monte_carlo.MonteCarlo.print_progress" title="Permalink to this definition">¶</a></dt>
<dd><p>Print progress to output.</p>
</dd></dl>

<dl class="method">
<dt id="edward.inferences.monte_carlo.MonteCarlo.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>feed_dict=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/edward/inferences/monte_carlo.html#MonteCarlo.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#edward.inferences.monte_carlo.MonteCarlo.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Run one iteration of sampling for Monte Carlo.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>feed_dict</strong> (<em>dict, optional</em>) &#8211; Feed dictionary for a TensorFlow session run. It is used to feed
placeholders that are not fed during initialization.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Dictionary of algorithm-specific information. In this case, the
acceptance rate of samples since (and including) this iteration.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>We run the increment of t separately from other ops. Whether the
others op run with the t before incrementing or after incrementing
depends on which is run faster in the TensorFlow graph. Running it
separately forces a consistent behavior.</p>
<p>Initialization is assumed from params[0, :]. This generalizes
initializing randomly and initializing from user input. Updates
are along this outer dimension, where iteration t updates
params[t, :] in each Empirical random variable.</p>
<p>No warm-up is implemented. Users must run MCMC for a long period
of time, then manually burn in the Empirical random variable.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="edward.inferences.variational_inference.html" class="btn btn-neutral float-right" title="edward.inferences.variational_inference module" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="edward.inferences.metropolis_hastings.html" class="btn btn-neutral" title="edward.inferences.metropolis_hastings module" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Edward Development Team.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>