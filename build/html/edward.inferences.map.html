

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>edward.inferences.map module &mdash; Edward 1.0.9 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Edward 1.0.9 documentation" href="index.html"/>
        <link rel="up" title="edward.inferences package" href="edward.inferences.html"/>
        <link rel="next" title="edward.inferences.monte_carlo module" href="edward.inferences.monte_carlo.html"/>
        <link rel="prev" title="edward.inferences.klqp module" href="edward.inferences.klqp.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Edward
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="inferences.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="criticisms.html">Criticism</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="edward.html">edward package</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="edward.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="edward.criticisms.html">edward.criticisms package</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="edward.inferences.html">edward.inferences package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="edward.inferences.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="edward.models.html">edward.models package</a></li>
<li class="toctree-l3"><a class="reference internal" href="edward.stats.html">edward.stats package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="edward.html#submodules">Submodules</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Edward</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="edward.html">edward package</a> &raquo;</li>
      
          <li><a href="edward.inferences.html">edward.inferences package</a> &raquo;</li>
      
    <li>edward.inferences.map module</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/edward.inferences.map.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-edward.inferences.map">
<span id="edward-inferences-map-module"></span><h1>edward.inferences.map module<a class="headerlink" href="#module-edward.inferences.map" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="edward.inferences.map.Laplace">
<em class="property">class </em><code class="descclassname">edward.inferences.map.</code><code class="descname">Laplace</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/edward/inferences/map.html#Laplace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#edward.inferences.map.Laplace" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#edward.inferences.map.MAP" title="edward.inferences.map.MAP"><code class="xref py py-class docutils literal"><span class="pre">edward.inferences.map.MAP</span></code></a></p>
<p>Laplace approximation.</p>
<p>It approximates the posterior distribution using a normal
distribution centered at the mode of the posterior.</p>
<p>We implement this by running <code class="docutils literal"><span class="pre">MAP</span></code> to find the posterior mode.
This forms the mean of the normal approximation. We then compute
the Hessian at the mode of the posterior. This forms the
covariance of the normal approximation.</p>
<dl class="method">
<dt id="edward.inferences.map.Laplace.finalize">
<code class="descname">finalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/edward/inferences/map.html#Laplace.finalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#edward.inferences.map.Laplace.finalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to call after convergence.</p>
<p>Computes the Hessian at the mode.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="edward.inferences.map.MAP">
<em class="property">class </em><code class="descclassname">edward.inferences.map.</code><code class="descname">MAP</code><span class="sig-paren">(</span><em>latent_vars</em>, <em>data=None</em>, <em>model_wrapper=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/edward/inferences/map.html#MAP"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#edward.inferences.map.MAP" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="edward.inferences.variational_inference.html#edward.inferences.variational_inference.VariationalInference" title="edward.inferences.variational_inference.VariationalInference"><code class="xref py py-class docutils literal"><span class="pre">edward.inferences.variational_inference.VariationalInference</span></code></a></p>
<p>Maximum a posteriori.</p>
<p>We implement this using a <code class="docutils literal"><span class="pre">PointMass</span></code> variational distribution to
solve the following optimization problem</p>
<div class="math">
\[\min_{z} - \log p(x,z)\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>latent_vars</strong> (<em>list of RandomVariable or</em>) &#8211; dict of RandomVariable to RandomVariable
Collection of random variables to perform inference on. If
list, each random variable will be implictly optimized
using a <code class="docutils literal"><span class="pre">PointMass</span></code> random variable that is defined
internally (with support matching each random variable).
If dictionary, each random variable must be a <code class="docutils literal"><span class="pre">PointMass</span></code>
random variable.</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Most explicitly, MAP is specified via a dictionary:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">qpi</span> <span class="o">=</span> <span class="n">PointMass</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">ed</span><span class="o">.</span><span class="n">to_simplex</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">K</span><span class="o">-</span><span class="mi">1</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmu</span> <span class="o">=</span> <span class="n">PointMass</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">D</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qsigma</span> <span class="o">=</span> <span class="n">PointMass</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softplus</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">D</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MAP</span><span class="p">({</span><span class="n">pi</span><span class="p">:</span> <span class="n">qpi</span><span class="p">,</span> <span class="n">mu</span><span class="p">:</span> <span class="n">qmu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">:</span> <span class="n">qsigma</span><span class="p">},</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>We also automate the specification of <code class="docutils literal"><span class="pre">PointMass</span></code> distributions
(with matching support), so one can pass in a list of latent
variables instead:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">MAP</span><span class="p">([</span><span class="n">beta</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MAP</span><span class="p">([</span><span class="n">pi</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">],</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>However, for model wrappers, the list can only have one element:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">MAP</span><span class="p">([</span><span class="s">&#39;z&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">,</span> <span class="n">model_wrapper</span><span class="p">)</span>
</pre></div>
</div>
<p>For example, the following is not supported:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">MAP</span><span class="p">([</span><span class="s">&#39;pi&#39;</span><span class="p">,</span> <span class="s">&#39;mu&#39;</span><span class="p">,</span> <span class="s">&#39;sigma&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">,</span> <span class="n">model_wrapper</span><span class="p">)</span>
</pre></div>
</div>
<p>This is because internally with model wrappers, we have no way
of knowing the dimensions in which to optimize each
distribution; further, we do not know their support. For more
than one random variable, or for constrained support, one must
explicitly pass in the point mass distributions.</p>
<dl class="method">
<dt id="edward.inferences.map.MAP.build_loss">
<code class="descname">build_loss</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/edward/inferences/map.html#MAP.build_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#edward.inferences.map.MAP.build_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Build loss function. Its automatic differentiation
is the gradient of</p>
<div class="math">
\[- \log p(x,z)\]</div>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="edward.inferences.monte_carlo.html" class="btn btn-neutral float-right" title="edward.inferences.monte_carlo module" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="edward.inferences.klqp.html" class="btn btn-neutral" title="edward.inferences.klqp module" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Edward Development Team.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.9',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>